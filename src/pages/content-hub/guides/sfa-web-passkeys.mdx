---
title: Using Passkeys with Web3Auth SFA Web SDK
image: "content-hub/guides/banners/auth0.png"
description: Learn how to use Web3Auth Single Factor Auth Web SDK with Passkeys in your React Application.
type: guide
tags:
  [
    web,
    "@web3auth/single-factor-auth",
    passkeys,
    custom authentication,
    react,
    ethereum,
    sms,
    email,
    sms passwordless,
    email passwordless,
    passwordless,
    sms otp,
  ]
date: 30 January, 2024
author: Web3Auth Team
order: 3
communityPortalTopicId: 22
---

import Auth0Prerequisites from "@site/src/common/guides/_auth0-prerequisites.mdx";
import Auth0Setup from "@site/src/common/guides/_auth0-setup.mdx";
import Auth0VerifierSetup from "@site/src/common/guides/_auth0-verifier-setup.mdx";
import InteractingWithBlockchain from "@site/src/common/guides/_interacting-with-blockchain.mdx";
import ParseIdtokenGetSub from "@site/src/common/guides/_parse-idtoken-get-sub.mdx";
import SetupBaseProject from "@site/src/common/guides/_setup-base-project.mdx";
import SetupWeb3AuthDashboard from "@site/src/common/guides/_setup-web3auth-dashboard.mdx";
import SfaWebAuth0Intialization from "@site/src/common/guides/_sfa-web-auth0-initialization.mdx";
import UserInfoFromIdtoken from "@site/src/common/guides/_user-info-from-idtoken.mdx";
import SFAWebInstantiation from "@site/src/common/guides/_w3a-sfa-web-instantiation-auth0.mdx";
import Web3AuthPrerequisites from "@site/src/common/guides/_web3auth-prerequisites.mdx";
import SFAInfra from "@site/static/images/sfa-infra.png";
import SEO from "@site/src/components/SEO";

<SEO
  title="Using Auth0 with Web3Auth SFA Web"
  description="Learn how to use Web3Auth Single Factor Auth with Auth0 in your React Application."
  image="https://web3auth.io/docs/content-hub/guides/banners/auth0.png"
  slug="/content-hub/guides/sfa-web-auth0"
/>

This guide will cover the basics of how to set up Passkeys with let's say, Web3Auth SFA Web SDK, for the integration and provide you with the links on
how to develop a basic web application on the blockchain of your choice.

## Quick Start

```bash
npx degit Web3Auth/web3auth-core-kit-examples/single-factor-auth-web/sfa-web-passkeys-example sfa-web-passkeys-demo && cd sfa-web-passkeys-demo && npm install && npm run start
```

## How it works?

Single Factor Auth SDKs allow for the integration of a single factor of authentication, such as social login, into your dApp. They are designed to be
simple to use and can be integrated into your dApp with minimal effort, allowing you to directly use the Web3Auth Network for Wallet Management. This
is one of the most common use cases of Web3Auth, however, it is semi-custodial in nature, since the key is custodial to the Auth Provider and the
Web3Auth Network.

<img style={{ display: "block", maxHeight: "600px", margin: "20px auto" }} src={SFAInfra} alt="Single Factor Auth SDK Infrastructure" />

- The first step for the application is to get the user authenticated by a login provider(here, Google) and get the user's `idToken`.
- Once the social login is successful, depending on whether the user has enabled **Multi-Factor Authentication(MFA)** or not, the key is generated.
- If the user has not enabled MFA, we use the `@web3auth/single-factor-auth` SDK to retrieve the private key shares from the Web3Auth auth network
  nodes and reconstruct the private key.
- If the user has enabled MFA, an error message is shown that the user has enabled MFA and in this case, they should be using the Web3Auth Plug and
  Play Web SDKs.

## Prerequisites

<Web3AuthPrerequisites />

## Setup your Web3Auth Dashboard

<SetupWeb3AuthDashboard />

## Using the Web3Auth SFA Web SDK

To use the Web3Auth SFA Web SDK, you need to add `@web3auth/single-factor-auth` to your project.

<SetupBaseProject />

### Installation

For this project, you need to add the following Web3Auth dependencies to your package.json

```shell
npm install --save @web3auth/single-factor-auth @web3auth/ethereum-provider @web3auth/base web3 @simplewebauthn/browser @toruslabs/http-helpers
```

#### Understanding the Dependencies

##### `@web3auth/base`

Since we're using typescript, we need the **`@web3auth/base`** package to provide the types of the different variables we'll be using throughout the
app-building process. This reduces errors to a very large extent.

```shell
npm install --save @web3auth/base
```

##### `@web3auth/ethereum-provider`

This package is used to provide the Ethereum provider to the Web3Auth SDK. This is required to interact with the blockchain.

```shell
npm install --save @web3auth/ethereum-provider
```

##### `@web3auth/single-factor-auth`

This package is the core package for Single Factor Auth Web SDK.

```shell
npm install --save @web3auth/single-factor-auth
```

##### `@simplewebauthn/browser`

This package is required for passkey registration and login.

```shell
npm install --save @simplewebauthn/browser
```

##### `web3`

This package is used to interact with the blockchain.

```shell
npm install --save web3
```

##### `@toruslabs/http-helpers`

This package is used to make HTTP requests, both GET or POST.

```shell
npm install --save @toruslabs/http-helpers
```

### Triggering registration for Passkeys

Once we get the email from the user, it's time to trigger the registration process for the user. This is done by calling the `startRegistration`
function from the `@simplewebauthn/browser` package.

```tsx
import { browserSupportsWebAuthn, startAuthentication, startRegistration } from "@simplewebauthn/browser";
import { get, post } from "@toruslabs/http-helpers";

const [email, setEmail] = useState<string>("");
const isWebAuthnSupported = browserSupportsWebAuthn();
const [isWebAuthnLoginEnabled, setIsWebAuthnLoginEnabled] = useState(false);
const [isWebAuthnRegistrationEnabled, setIsWebAuthnRegistrationEnabled] = useState(false);

const triggerPassKeyRegistration = async () => {
  try {
    const url = new URL("https://wc-admin.web3auth.com/api/v2/webauthn-generate-registration-options");
    url.searchParams.append("email", email);
    const resp = await get(url.href);
    const attestationResponse = await startRegistration(resp as any);
    const url2 = new URL("https://wc-admin.web3auth.com/api/v2/webauthn-verify-registration");
    const resp2 = await post<{ verified: boolean }>(url2.href, { attestationResponse, email });
    if (resp2.verified) {
      setIsWebAuthnRegistrationEnabled(false);
      setIsWebAuthnLoginEnabled(true);
      console.log("Registration successful, Proceed to Login");
    } else {
      throw new Error("Registration failed");
    }
  } catch (error) {
    console.error(error);
  }
};
```

### Initialization

Once installed, your Web3Auth application needs to be initialized. Initialization is a multi-step process where we add all the config details for
Web3Auth SDK:

<SFAWebInstantiation />

#### Initializing the Web3Auth SDK

```tsx
web3authSfa.init(privateKeyProvider);
```

### Authentication

#### Getting the `idToken` from Passkeys server upon login

```tsx
import { browserSupportsWebAuthn, startAuthentication, startRegistration } from "@simplewebauthn/browser";
import { Web3Auth } from "@web3auth/single-factor-auth";
import { get, post } from "@toruslabs/http-helpers";

const [web3Auth, setWeb3Auth] = useState<Web3Auth | null>(null);
const [provider, setProvider] = useState<any | null>(null);
const [connected, setConnected] = useState<boolean>(false);

const login = async () => {
  if (!web3Auth) {
    uiConsole("web3auth not initialized yet");
    return;
  }

  if (isWebAuthnLoginEnabled) {
    const idToken = await triggerPassKeyLogin();
    await web3Auth.connect({
      verifier,
      idToken: idToken!,
      verifierId: email!,
    });
    if (web3Auth.status === "connected") {
      setConnected(true);
      setProvider(web3Auth.provider);
    }
  } else {
    uiConsole("Please register first");
  }
};

const triggerPassKeyLogin = async () => {
  try {
    const url = new URL("https://wc-admin.web3auth.com/api/v2/webauthn-generate-authentication-options");
    url.searchParams.append("email", email);
    const resp = await get(url.href);
    const attestationResponse = await startAuthentication(resp as any);
    const url2 = new URL("https://wc-admin.web3auth.com/api/v2/webauthn-verify-authentication");
    const resp2 = await post<{ verified: boolean; id_token: string }>(url2.href, { attestationResponse, email });
    if (resp2.verified) {
      return resp2.id_token;
    }
    throw new Error("Login failed");
  } catch (error) {
    console.error(error);
  }
};
```

### Logout

Logging out your user is as simple as calling the `logout` function on the Web3Auth SDK.

```tsx
await web3authSfa.logout();
```

## Interacting with the Blockchain

<InteractingWithBlockchain />

## Example Code

The code for the example can be found
[here](https://github.com/Web3Auth/web3auth-core-kit-examples/tree/main/single-factor-auth-web/sfa-web-auth0-example).

## Questions?

Ask us on [Web3Auth Community Portal](https://web3auth.io/community/c/help-core-kit/core-kit-sfa-web/22).
